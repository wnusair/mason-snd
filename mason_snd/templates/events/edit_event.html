{% extends "events/base.html" %}

{% block title %}Edit Event{% endblock %}

{% block content %}
<div class="min-h-full flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full space-y-8">
        <div>
            <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">
                Edit {{ event.event_name }}
            </h2>
        </div>
        <form class="mt-8 space-y-6" action="{{ url_for('events.edit_event', event_id=event.id) }}" method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <div class="rounded-md shadow-sm space-y-4">
                <div>
                    <label for="event_name" class="block text-sm font-medium text-gray-700">Event Name</label>
                    <input id="event_name" name="event_name" type="text" required value="{{ event.event_name }}" class="mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-[color:var(--color-primary-500)] focus:border-[color:var(--color-primary-500)] sm:text-sm">
                </div>
                <div>
                    <label for="event_description" class="block text-sm font-medium text-gray-700">Event Description</label>
                    <textarea id="event_description" name="event_description" rows="3" required class="mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-[color:var(--color-primary-500)] focus:border-[color:var(--color-primary-500)] sm:text-sm">{{ event.event_description }}</textarea>
                </div>
                <div>
                    <label for="event_type" class="block text-sm font-medium text-gray-700">Event Type</label>
                    <select id="event_type" name="event_type" required class="mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-[color:var(--color-primary-500)] focus:border-[color:var(--color-primary-500)] sm:text-sm">
                        <option value="">Select an event type...</option>
                        <option value="0" {% if event.event_type == 0 %}selected{% endif %}>Speech</option>
                        <option value="1" {% if event.event_type == 1 %}selected{% endif %}>Lincoln-Douglas (LD)</option>
                        <option value="2" {% if event.event_type == 2 %}selected{% endif %}>Public Forum (PF)</option>
                    </select>
                </div>
                <div>
                    <label for="event_emoji" class="block text-sm font-medium text-gray-700">Event Emoji</label>
                    <input id="event_emoji" name="event_emoji" type="text" required value="{{ event.event_emoji }}" class="mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-[color:var(--color-primary-500)] focus:border-[color:var(--color-primary-500)] sm:text-sm">
                </div>
                <div>
                    <label class="flex items-center space-x-2">
                        <input type="checkbox" id="is_partner_event" name="is_partner_event" {% if event.is_partner_event %}checked{% endif %} class="rounded border-gray-300 text-[color:var(--color-primary-600)] focus:ring-[color:var(--color-primary-500)]">
                        <span class="text-sm font-medium text-gray-700">This is a partner event</span>
                    </label>
                    <p class="mt-1 text-sm text-gray-500">When enabled, participants can search for and select partners when signing up for tournaments in this event.</p>
                </div>
            </div>

            <div>
                <button type="submit" class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-[color:var(--color-primary-600)] hover:bg-[color:var(--color-primary-700)] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[color:var(--color-primary-500)]">
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// Add some client-side validation and UX improvements
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form');
    const eventTypeSelect = document.getElementById('event_type');
    const emojiInput = document.getElementById('event_emoji');
    
    // Add emoji suggestions based on event type
    eventTypeSelect.addEventListener('change', function() {
        const selectedType = this.value;
        let suggestedEmoji = '';
        
        switch(selectedType) {
            case '0': // Speech
                suggestedEmoji = '🎤';
                break;
            case '1': // LD
                suggestedEmoji = '⚖️';
                break;
            case '2': // PF
                suggestedEmoji = '🗣️';
                break;
        }
        
        // Only suggest emoji if current field is empty or user wants to change it
        if (suggestedEmoji && confirm('Would you like to change the emoji to the suggested one for this event type?')) {
            emojiInput.value = suggestedEmoji;
        }
    });
    
    // Limit emoji input to 2 characters
    emojiInput.addEventListener('input', function() {
        if (this.value.length > 2) {
            this.value = this.value.slice(0, 2);
        }
    });
    
    // Form validation
    form.addEventListener('submit', function(e) {
        const eventType = eventTypeSelect.value;
        if (!eventType) {
            e.preventDefault();
            alert('Please select an event type.');
            eventTypeSelect.focus();
        }
    });
});
</script>
{% endblock %}
