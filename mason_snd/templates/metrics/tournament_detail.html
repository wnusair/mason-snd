{% extends "metrics/base.html" %}
{% block title %}Tournament Details{% endblock %}

{% block content %}
<h2>{{ tournament.name }}</h2>

<div class="mb-3">
    <a href="{{ url_for('metrics.download_user_metrics_for_tournament', tournament_id=tournament.id) }}" class="btn btn-success">Download User Metrics CSV</a>
</div>

<h4>Top Performers</h4>
<table class="table table-striped">
    <thead>
        <tr>
            <th>User</th>
            <th>Total Points</th>
            <th>Tournament Points</th>
            <th>Weighted Points</th>
        </tr>
    </thead>
    <tbody>
        {% for performer in top_performers %}
        <tr>
            <td><a href="{{ url_for('metrics.user_detail', user_id=performer.user.id) }}">{{ performer.user.first_name }} {{ performer.user.last_name }}</a></td>
            <td>{{ performer.total_points }}</td>
            <td>{{ performer.tournament_points }}</td>
            <td>{{ performer.weighted_points | round(2) }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<h4>Event Performance</h4>
<p>Average event performance (compared to tournament points): {{ event_performance_avg }}</p>

{% endblock %}
