{% extends "metrics/base.html" %}
{% block title %}Events Overview{% endblock %}

{% block content %}
<h2>Events Overview</h2>

<div class="mb-3">
    <a href="{{ url_for('metrics.index') }}" class="btn btn-secondary">User Metrics</a>
    <a href="{{ url_for('metrics.tournaments_overview') }}" class="btn btn-secondary">Tournaments Overview</a>
    <a href="{{ url_for('metrics.download_events', sort=sort, direction=direction) }}" class="btn btn-success">Download as CSV</a>
    <a href="{{ url_for('metrics.settings') }}" class="btn btn-primary">Settings</a>
</div>

<table class="table table-striped">
    <thead>
        <tr>
            <th><a href="{{ url_for('metrics.events_overview', sort='name', direction=next_direction('name')) }}">Event Name</a></th>
            <th><a href="{{ url_for('metrics.events_overview', sort='weighted_points', direction=next_direction('weighted_points')) }}">Weighted Points</a></th>
            <th><a href="{{ url_for('metrics.events_overview', sort='total_points', direction=next_direction('total_points')) }}">Total Points</a></th>
            <th><a href="{{ url_for('metrics.events_overview', sort='effort_points', direction=next_direction('effort_points')) }}">Effort Points</a></th>
            <th><a href="{{ url_for('metrics.events_overview', sort='tournament_points', direction=next_direction('tournament_points')) }}">Tournament Points</a></th>
        </tr>
    </thead>
    <tbody>
        {% for event in events.items %}
        <tr>
            <td><a href="{{ url_for('events.manage_members', event_id=event.id) }}">{{ event.event_name }}</a></td>
            <td>{{ event_points[event.id].weighted_points | round(2) }}</td>
            <td>{{ event_points[event.id].total_points }}</td>
            <td>{{ event_points[event.id].effort_points }}</td>
            <td>{{ event_points[event.id].tournament_points }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<nav aria-label="Event pagination">
  <ul class="pagination">
    {% if events.has_prev %}
      <li class="page-item"><a class="page-link" href="{{ url_for('metrics.events_overview', page=events.prev_num, sort=sort, direction=direction) }}">Previous</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Previous</span></li>
    {% endif %}
    <li class="page-item disabled"><span class="page-link">Page {{ events.page }} of {{ events.pages }}</span></li>
    {% if events.has_next %}
      <li class="page-item"><a class="page-link" href="{{ url_for('metrics.events_overview', page=events.next_num, sort=sort, direction=direction) }}">Next</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Next</span></li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
