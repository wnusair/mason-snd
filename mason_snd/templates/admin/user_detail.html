{% extends "admin/base.html" %}
{% block title %}User Details{% endblock %}

{% block content %}
<div class="px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div>
        <h1 class="text-2xl font-bold text-gray-900 capitalize">{{ user.first_name }} {{ user.last_name }}</h1>
        <p class="mt-1 text-sm text-gray-500">Viewing details for User ID: {{ user.id }}</p>
    </div>

    <div class="mt-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Left Column: Key Info -->
        <div class="lg:col-span-1 space-y-6">
            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-medium text-gray-900">Contact Information</h3>
                <dl class="mt-4 space-y-2 text-sm">
                    <div class="flex justify-between">
                        <dt class="text-gray-500">Email</dt>
                        <dd class="text-gray-900 font-medium">{{ user.email }}</dd>
                    </div>
                    <div class="flex justify-between">
                        <dt class="text-gray-500">Phone</dt>
                        <dd class="text-gray-900 font-medium">{{ user.phone_number }}</dd>
                    </div>
                </dl>
            </div>
            
            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-medium text-gray-900">Performance Metrics</h3>
                 <dl class="mt-4 space-y-2 text-sm">
                    <div class="flex justify-between">
                        <dt class="text-gray-500">Weighted Points</dt>
                        <dd class="text-gray-900 font-bold text-[color:var(--color-primary-600)]">{{ weighted_points | round(2) }}</dd>
                    </div>
                    <div class="flex justify-between">
                        <dt class="text-gray-500">Total Points</dt>
                        <dd class="text-gray-900 font-medium">{{ total_points }}</dd>
                    </div>
                    <div class="flex justify-between">
                        <dt class="text-gray-500">Tournament Points</dt>
                        <dd class="text-gray-900 font-medium">{{ tournament_points }}</dd>
                    </div>
                     <div class="flex justify-between">
                        <dt class="text-gray-500">Effort Points</dt>
                        <dd class="text-gray-900 font-medium">{{ effort_points }}</dd>
                    </div>
                </dl>
            </div>

            {% if user.is_parent and child_info %}
            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-medium text-gray-900">Child Info</h3>
                <p class="mt-2 text-sm text-gray-600 capitalize">{{ child_info.first_name }} {{ child_info.last_name }}</p>
            </div>
            {% endif %}

            {% if emergency_contact %}
            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-medium text-gray-900">Emergency Contact</h3>
                <p class="mt-2 text-sm text-gray-600 capitalize">{{ emergency_contact.first_name }} {{ emergency_contact.last_name }} ({{ emergency_contact.relationship }})</p>
                <p class="mt-1 text-sm text-gray-500">{{ emergency_contact.email }}</p>
                <p class="mt-1 text-sm text-gray-500">{{ emergency_contact.number }}</p>
            </div>
            {% endif %}
        </div>

        <!-- Right Column: Requirements & Events -->
        <div class="lg:col-span-2 space-y-6">
            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-medium text-gray-900">Requirements</h3>
                <ul role="list" class="mt-4 divide-y divide-gray-200">
                    {% for req in requirements %}
                    <li class="py-3 flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-900">{{ req.requirement.body }}</p>
                            {% if req.deadline %}<p class="text-xs text-gray-500">Deadline: {{ req.deadline.strftime('%Y-%m-%d') }}</p>{% endif %}
                        </div>
                        {% if req.complete %}
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Complete</span>
                        {% else %}
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Incomplete</span>
                        {% endif %}
                    </li>
                    {% else %}
                    <li class="py-3 text-sm text-gray-500">No requirements found.</li>
                    {% endfor %}
                </ul>
            </div>
             <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-medium text-gray-900">Events Attended</h3>
                 <ul role="list" class="mt-4 divide-y divide-gray-200">
                    {% for event in events %}
                    <li class="py-3 text-sm font-medium text-gray-700">{{ event.event_name }}</li>
                    {% else %}
                    <li class="py-3 text-sm text-gray-500">No events found.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
