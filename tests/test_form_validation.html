<!DOCTYPE html>
<html>
<head>
    <title>Registration Form Test</title>
    <style>
        .hidden { display: none; }
        .text-red-500 { color: red; }
        .space-y-4 > * + * { margin-top: 1rem; }
    </style>
</head>
<body>
    <!-- Test simplified version of our registration form -->
    <form id="test-form">
        <fieldset>
            <legend>Are you a parent? <span class="text-red-500">*</span></legend>
            <div>
                <input id="parent_yes" name="is_parent" type="radio" value="yes" required>
                <label for="parent_yes">Yes</label>
            </div>
            <div>
                <input id="parent_no" name="is_parent" type="radio" value="no" required>
                <label for="parent_no">No</label>
            </div>
        </fieldset>

        <div id="child-contact" class="hidden space-y-4">
            <h3>Child's Information <span class="text-red-500">*</span></h3>
            <input type="text" name="child_first_name" id="child_first_name" placeholder="Child's first name *">
            <input type="text" name="child_last_name" id="child_last_name" placeholder="Child's last name *">
        </div>

        <div id="emergency-contact" class="hidden space-y-4">
            <h3>Emergency Contact <span class="text-red-500">*</span></h3>
            <input type="text" name="emergency_first_name" id="emergency_first_name" placeholder="First name *">
            <input type="text" name="emergency_last_name" id="emergency_last_name" placeholder="Last name *">
            <input type="email" name="emergency_email" id="emergency_email" placeholder="Email *">
            <input type="tel" name="emergency_phone" id="emergency_phone" placeholder="Phone number *">
            <input type="text" name="emergency_relationship" id="emergency_relationship" placeholder="Relationship *">
        </div>

        <button type="submit">Test Submit</button>
    </form>

    <script>
        const parentYes = document.getElementById('parent_yes');
        const parentNo = document.getElementById('parent_no');
        const childContact = document.getElementById('child-contact');
        const emergencyContact = document.getElementById('emergency-contact');

        // Get all the form fields that need conditional required validation
        const childFields = [
            document.getElementById('child_first_name'),
            document.getElementById('child_last_name')
        ];
        
        const emergencyFields = [
            document.getElementById('emergency_first_name'),
            document.getElementById('emergency_last_name'),
            document.getElementById('emergency_email'),
            document.getElementById('emergency_phone'),
            document.getElementById('emergency_relationship')
        ];

        function toggleContactForms() {
            if (parentYes.checked) {
                // Show child information, hide emergency contact
                childContact.classList.remove('hidden');
                emergencyContact.classList.add('hidden');
                
                // Make child fields required, emergency fields not required
                childFields.forEach(field => field.setAttribute('required', 'required'));
                emergencyFields.forEach(field => field.removeAttribute('required'));
            } else if (parentNo.checked) {
                // Show emergency contact, hide child information
                childContact.classList.add('hidden');
                emergencyContact.classList.remove('hidden');
                
                // Make emergency fields required, child fields not required
                emergencyFields.forEach(field => field.setAttribute('required', 'required'));
                childFields.forEach(field => field.removeAttribute('required'));
            }
        }

        parentYes.addEventListener('change', toggleContactForms);
        parentNo.addEventListener('change', toggleContactForms);

        // Test form submission
        document.getElementById('test-form').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Form validation test: ' + (this.checkValidity() ? 'PASSED' : 'FAILED'));
        });

        console.log('Form validation test loaded successfully');
    </script>
</body>
</html>
